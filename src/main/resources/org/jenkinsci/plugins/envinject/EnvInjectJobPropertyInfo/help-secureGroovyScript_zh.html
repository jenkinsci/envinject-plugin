<div>
    <p>
      评估 Groovy 脚本并将结果注入到环境中。
      此脚本由 <a href="https://plugins.jenkins.io/script-security">Script Security Plugin</a> 提供支持；
Approved Script 和 Groovy Sandbox 模式均可用。
      对于新脚本，建议使用 Sandbox 模式。
    </p>

    <h3>用法</h3>
    <p>
      Groovy 脚本必须返回一个 <code>Map&lt;String,String&gt;</code> Java 对象。
      您可以通过 Groovy 脚本中的变量取参数和其他环境变量。
      在脚本中，您还可以使用以下变量。
    </p>
    <dl>
      <dt>currentJob</dt>
      <dd>当前 <a href="https://javadoc.jenkins.io/hudson/model/Job.html">hudson.model.Job</a> 实例。</dd>
      <dt>currentBuild</dt>
      <dd>当前 <a href="https://javadoc.jenkins.io/hudson/model/Run.html">hudson.model.Run</a> 实例。</dd>
      <dt>currentListener</dt>
      <dd>当前 <a href="https://javadoc.jenkins.io/hudson/model/TaskListener.html">hudson.model.TaskListener</a> 实例，可用于记录目的。
      </dd>
      <dt>out</dt>
      <dd>另一个记录实例为 <a href="https://docs.oracle.com/javase/8/docs/api/java/io/PrintStream.html">java.io.PrintStream</a>。
        建议尽可能使用 <code>currentListener</code> 代替此变量。
      </dd>
    </dl>
    <p>
      所有列出的变量都可以在两种脚本模式下使用。
      在沙盒模式下，对特定字段和方法的取数可能需要额外的批准。
    </p>

    <h3>例子</h3>
    <p>
      例如，Groovy 可以根据用户输入参数计算环境变量。
      下面的脚本根据 CASE 参数值注入 <code>COMPUTE_VAR</code> 环境变量。
    </p>
        <pre><code>
          def stringValue="StRinG";
          if ("upper".equals(CASE)){
            def map = ["COMPUTE_VAR": stringValue.toUpperCase()]
            return map
          } else if ("lower".equals(CASE)){
            def map = ["COMPUTE_VAR": stringValue.toLowerCase()]
            return map
          } else {
            return null;
          }
        </code></pre>
</div>
